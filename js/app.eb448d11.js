(function(t){function e(e){for(var a,i,r=e[0],l=e[1],c=e[2],d=0,p=[];d<r.length;d++)i=r[d],n[i]&&p.push(n[i][0]),n[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],a=!0,r=1;r<o.length;r++){var l=o[r];0!==n[l]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=o[0]))}return t}var a={},n={app:0},s=[];function i(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=a,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(o,a,function(e){return t[e]}.bind(null,a));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";var a=o("64a9"),n=o.n(a);n.a},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("097d");var a=o("2b0e"),n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",[o("b-input",{attrs:{placeholder:"現場住所入力",id:"addAddress"},on:{focus:t.modalOpen}}),o("b-input",{attrs:{placeholder:"経度緯度入力",id:"addLatlng"},on:{focus:t.modalOpen}}),o("b-modal",{attrs:{active:t.isComponentModalActive,"has-modal-card":""},on:{"update:active":function(e){t.isComponentModalActive=e}}},[o("modal-form")],1)],1)},s=[],i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-card"},[o("section",{staticClass:"modal-card-body"},[t._m(0),o("div",{attrs:{id:"addressSearchBase"}},[o("b-field",{staticClass:"field_base",attrs:{label:"住所検索"}},[o("form",{staticClass:"addressSearch_wrapper",on:{submit:function(e){e.preventDefault(),t.getGeocode({address:t.searchBox.value},!0)}}},[o("b-input",{attrs:{placeholder:"住所キーワードから検索できます",icon:"magnify",onfocus:"this.select();"},model:{value:t.searchBox.value,callback:function(e){t.$set(t.searchBox,"value",e)},expression:"searchBox.value"}}),o("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[t._v("検索")])],1),o("transition",{attrs:{name:"result-trans"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.transFlag,expression:"transFlag"}],staticClass:"addressSearchResult_base"},[o("div",{staticClass:"addressLine"},[o("b-icon",{staticStyle:{color:"#666666"},attrs:{icon:"map-search-outline",size:"is-small"}}),t._v(t._s(t.addressBox.value))],1),o("div",{staticClass:"latlngLine"},[o("b-icon",{attrs:{icon:"earth",size:"is-small"}}),t._v(t._s(t.latlongBox.value))],1)])])],1)],1),o("button",{staticClass:"button getNowPosition",staticStyle:{color:"#666666"},attrs:{disabled:!t.hasGeolocation},on:{click:function(e){t.rewindPosition()}}},[o("b-icon",{attrs:{icon:"crosshairs-gps"}})],1)]),o("footer",{staticClass:"modal-card-foot"},[o("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){t.$parent.close()}}},[t._v("キャンセル")]),o("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.setPlaceData}},[t._v("情報設定")])])])},r=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"mapwrapper"}},[o("div",{attrs:{id:"map"}})])}],l=(o("4917"),o("a481"),o("5d73")),c=o.n(l),u=(o("6b54"),o("a709")),d={name:"ModalForm",props:{},data:function(){return{transFlag:!0,hasGeolocation:"geolocation"in navigator,isGPSworking:!1,mapObj:{mapElm:{},latLng:{lat:37.8629704,lng:136.4834582},zoom:6,marker:{},infoWindow:{},autocomplete:{},geocoder:{},map:{}},searchBox:{value:""},addressBox:{value:""},latlongBox:{value:""},target:{address:{},latlng:{}},googleMaps:{},targetMapElem:{}}},computed:{},watch:{"mapObj.latLng":{handler:function(t,e){this.latlongBox.value=this.mapObj.latLng.toString()},deep:!0}},methods:{initGoogleMaps:function(){var t=this;u({key:"AIzaSyApvOihEARIgFwXudP7i6IM2oob9QryW7g",language:"ja",libraries:["places"]}).then(function(e){t.googleMaps=e,t.initDefaultLatLng(),t.initMap(),t.initGeocorder(),t.setNowPosition(function(e){e&&t.setMarkerFirst()})}).catch(function(t){console.error(t)})},initMap:function(){var t=this;this.mapObj.map=new this.googleMaps.Map(this.mapObj.mapElm,{center:this.mapObj.latLng,zoom:this.mapObj.zoom,fullscreenControl:!1,mapTypeControl:!1,streetViewControl:!1}),this.mapObj.map.addListener("click",t.clickMap)},initDefaultLatLng:function(){this.mapObj.latLng=new google.maps.LatLng(this.mapObj.latLng)},clickMap:function(t){var e=this.mapObj.map,o=this.mapObj.marker,a=e.getBounds(),n=(t.latLng,o.getPosition());console.log(a.intersects(new google.maps.LatLngBounds(n))),a.intersects(new google.maps.LatLngBounds(n))||(o.setPosition(t.latLng),this.dragendMarker(t))},setMarkerFirst:function(){this.mapObj.marker=new google.maps.Marker({position:this.mapObj.latLng,map:this.mapObj.map,draggable:!0,animation:google.maps.Animation.DROP}),this.mapObj.infoWindow=new google.maps.InfoWindow({content:""}),this.getGeocode({location:this.mapObj.latLng},!0);var t=this.mapObj.map,e=this.mapObj.marker,o=this.mapObj.infoWindow;e.addListener("dragstart",function(){o.close()}),e.addListener("dragend",this.dragendMarker),e.addListener("click",function(){o.open(t,e)})},dragendMarker:function(t){var e=this.mapObj.map,o=this.mapObj.marker,a=this.mapObj.infoWindow,n=this,s=document.createElement("button");s.innerText="再取得",s.addEventListener("click",function(){console.log("geocode research"),n.getGeocode({location:t.latLng},!1)},!1);var i=document.createElement("div");i.innerHTML="マーカー位置が変更されました。この位置情報で再取得しますか？<br>(lat,lng) = "+t.latLng.toString()+"<br>",i.appendChild(s),a.setContent(i),a.open(e,o)},rewindPosition:function(){this.mapObj.map,this.mapObj.marker;var t=this;this.setNowPosition(function(e){e&&t.getGeocode({location:t.mapObj.latLng},!0)})},setNowPosition:function(t){var e=this,o=t;this.hasGeolocation?navigator.geolocation.getCurrentPosition(function(t){e.isGPSworking=!0,e.mapObj.zoom=16,e.mapObj.latLng=new e.googleMaps.LatLng({lat:t.coords.latitude,lng:t.coords.longitude}),e.UIctrl().toast("現在地で初期化されました","is-info"),o&&o(!0)},function(t){e.UIctrl().toast("GPS情報は取得できませんでした","is-info"),o&&o(!1)}):(this.UIctrl().toast("この端末でのGPS情報は取得できません","is-warning"),o&&o(!1))},initGeocorder:function(){this.mapObj.geocoder=new this.googleMaps.Geocoder},initAutocomplete:function(){var t=document.querySelector(".addresses .input"),e=this.googleMaps.LatLng(35.692195,139.7576653),o=this.googleMaps.LatLng(35.696157,139.7525771),a=this.googleMaps.LatLngBounds(e,o),n={types:["geocode"],bounds:a,componentRestrictions:{country:"jp"}};this.mapObj.autocomplete=new this.googleMaps.places.Autocomplete(t,n)},UIctrl:function(){var t=this;return{toast:function(e,o,a,n){var s=o||"is-white",i=e||"",r=a||"is-top",l=n||5e3;t.$toast.open({duration:l,message:i,position:r,type:s})}}},doForcus:function(t,e,o){t.inFocus=e},getGeocode:function(t,e){this.searchBox.value="",this.transFlag=!1;var o=e,a=this,n=!!t.location,s=n?t.location:{};this.mapObj.geocoder.geocode(t,function(t,e){if(e==a.googleMaps.GeocoderStatus.OK){new a.googleMaps.LatLngBounds;for(var i=a.mapObj.map,r=a.mapObj.infoWindow,l=a.mapObj.marker,u=(a.mapObj.latLng,[]),d=0;d<t.length;d++){if(!n){u=t;break}if("APPROXIMATE"==t[d].geometry.location_type){var p=!0,g=!1,m=void 0;try{for(var f,h=c()(t[d].types);!(p=(f=h.next()).done);p=!0){var b=f.value;if("political"==b){u.push(t[d]);break}}}catch(L){g=!0,m=L}finally{try{p||null==h.return||h.return()}finally{if(g)throw m}}}}if(u[0].geometry){var v=n?s:u[0].geometry.location,O=u[0].formatted_address.replace(/^日本、/,"");a.mapObj.latLng=v,a.addressBox.value=O,l.setPosition(v),r.setContent(O+"<br>(Lat, Lng) = "+v.toString()),r.open(i,l)}o&&u[0].geometry.bounds&&i.fitBounds(u[0].geometry.bounds)}else e==google.maps.GeocoderStatus.ERROR?alert("サーバとの通信時に何らかのエラーが発生！"):e==google.maps.GeocoderStatus.INVALID_REQUEST?alert("リクエストに問題アリ！geocode()に渡すGeocoderRequestを確認せよ！！"):e==google.maps.GeocoderStatus.OVER_QUERY_LIMIT?alert("短時間にクエリを送りすぎ！落ち着いて！！"):e==google.maps.GeocoderStatus.REQUEST_DENIED?alert("このページではジオコーダの利用が許可されていない！・・・なぜ！？"):e==google.maps.GeocoderStatus.UNKNOWN_ERROR?alert("サーバ側でなんらかのトラブルが発生した模様。再挑戦されたし。"):e==google.maps.GeocoderStatus.ZERO_RESULTS?alert("見つかりません"):alert("不明のエラー");setTimeout(function(){a.transFlag=!0},1e3)})},setPlaceData:function(){this.target.address.value=this.addressBox.value,this.target.latlng.value=this.latlongBox.value.match(/\((.*)\)/i)[1],this.$parent.close()}},created:function(){this.target.address=document.querySelector("#addAddress"),this.target.latlng=document.querySelector("#addLatlng")},mounted:function(){this.initGoogleMaps(),this.mapObj.mapElm=document.getElementById("map")}},p=d,g=(o("b83a"),o("2877")),m=Object(g["a"])(p,i,r,!1,null,null,null);m.options.__file="ModalForm.vue";var f=m.exports,h={components:{ModalForm:f},data:function(){return{isComponentModalActive:!1}},methods:{modalOpen:function(){this.$modal.open({parent:this,component:f,hasModalCard:!0,canCancel:["escape"]})}}},b=h,v=(o("034f"),Object(g["a"])(b,n,s,!1,null,null,null));v.options.__file="App.vue";var O=v.exports,L=o("8a03"),j=o.n(L);o("5abe");a["default"].use(j.a),a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(O)}}).$mount("#app")},"64a9":function(t,e,o){},"8bc7":function(t,e,o){},b83a:function(t,e,o){"use strict";var a=o("8bc7"),n=o.n(a);n.a}});
//# sourceMappingURL=app.eb448d11.js.map